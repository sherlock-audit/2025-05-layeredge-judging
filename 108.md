Dry Blush Pony

High

# ğŸ”´ High Severity: Unsafe ERC20 transfers â€“ missing return value checks

## ğŸ§¨ Issue: Unsafe ERC20 transfers â€“ missing return value checks

**File:** `edgen-staking/src/stake/LayerEdgeStaking.sol`  
**Line:** 253  
```solidity
require(stakingToken.transferFrom(msg.sender, address(this), amount), "Token transfer failed");

This line uses transferFrom() directly without wrapping it in a safe transfer abstraction (e.g. OpenZeppelinâ€™s SafeERC20). Some real-world ERC20 tokens (e.g., USDT, BNB, Tether Gold) do not revert or return a proper bool on failure, which can lead to silent transfer failures and cause the contractâ€™s internal accounting (rewardsReserve, user balances, tier assignment) to become inconsistent.

ğŸ” Impact
Funds may not be transferred as expected.

Users could be credited or debited incorrectly.

Attackers can exploit non-standard tokens to drain or lock funds.

âœ… Recommendation
Replace direct transfer()/transferFrom() calls with OpenZeppelinâ€™s SafeERC20 methods:
using SafeERC20 for IERC20;
// ...
stakingToken.safeTransferFrom(msg.sender, address(this), amount);

This ensures that any failure in the token transfer is properly detected and reverted.


